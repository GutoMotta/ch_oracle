Experimentos

Primeira tentativa:
  - STFT
  - Templates binários

Alterações:
  - CQT
  - Templates aprendidos
  - Normalização das cromas
  - Normalização dos templates
  - Suavização temporal
  - Distância euclidiana
  - Filtragem de outliers

Estrutura dos experimentos:
  Depende do librosa:
    - CQT ou STFT
    - Templates aprendidos

  Depois de extrair o chroma:
    - Normalização das cromas
    - Normalização dos templates
    - Suavização temporal
    - Distância euclidiana
    - Filtragem de outliers

Escolhas:
  cromas [ STFT,      CQT                ]
  simil. [ dot,       euclid             ]
  cromas [ norm-inf,  norm2              ]
  templ. [ bin,       avg,    norm-templ ]
  cromas [ none,      suav               ]


RELATOS:
  1
    Tentei dividir por 2 as intensidades das notas nos templates aprendidos
    quando elas não eram pertencentes ao acorde em si. Fiz no

      stft_t(stft-2-2)_2_0_no-pf

    A precisão caiu de 26.73 para 24.53


  2
    Estou tentando extrair cromas com potência 3 em vez de 2.

    A lógica por trás disso é que quero ampliar as diferenças de intensidade
    entre as notas que de fato são tocadas e as frequências que aparecem por
    serem harmônicos, ruído etc.

    Com isso, o template aprendido deveria refletir esse aumento de distâncias
    e ficar mais realista (mais próximo do binário).

    Inclusive, os templates aprendidos estão tão distantes dos binários que
    em alguns casos, quando peço o best match desses chromas com os templates
    binários, o acorde reconhecido vem diferente do label do template.

    Isso aconteceu em 3 casos específicos. 2 num mesmo fold, 1 em outro.

    Os templates que deram best match com acordes diferentes do próprio foram
    o do G#:min (que caiu no B, em duas ocorrências) e o do D#:min (que caiu
    em D#)

  3
    Comecei a olhar para os reconhecimentos que têm precisão muito baixa.

    O pior de todos, com precisão muito próxima de 0, é a canção Lovely Rita.

    O motivo de isto acontecer é que ela está afinada em 430 Hz em vez de
    440 Hz, o que faz com que todos os acordes sejam reconhecidos um semitom
    abaixo.

    Chris Harte cita isso na tese dele, junto com algumas outras músicas que
    costumam ser problemáticas.

    Vou tentar estimar a afinação da música antes de rodar o reconhecimento e
    ver o que acontece.

    ----------------------

    Estimei a afinação. As intensidades do chromagrama estão sendo calculadas
    com mais proximidade das notas agora. Isso pode ser bom tanto usando
    templates binários como aprendendo templates (usando chromas com estimativa
    de afinação como base para o aprendizado).

    A Librosa recebe um parâmetro 'resolução' no método de estimativa de
    afinação, que por padrão é 1e-2. Quanto menor for o valor desse parâmetro,
    mais precisa será a estimativa de tuning. Porém, essa melhoria tem um custo
    computacional considerável.

    O valor de resolução que fez uma diferença aparente sem prejudicar muito o
    desempenho do reconhecimento foi 1e-6. O aumento no tempo para extração dos
    acordes de um sinal com esse parâmetro foi de 18%.

    Com resolução de 1e-6, a estimativa de pitch melhora o reconhecimento de
    algumas músicas (como Lovely Rita, por exemplo), mas piora o de outras,
    fazendo com que a média abaixe um pouquinho. Pensei que talvez a
    distribuição ficasse mais homogênea com esse setup, mas não: ela fica muito
    parecida.

    Depois quero testar outros parâmetros de resolução e ver se há algum que
    traz um impacto positivo.

    Outra análise que vale a pena fazer: será que a distribuição continua a
    mesma pelo mesmo motivo? O que está fazendo com que algumas músicas sejam
    classificadas com uma precisão alta e outras com precisão baixa?

  4
    Encontrei a definição dos tamanhos de janela e hop no Müller. Refazer os
    testes usando esses novos parâmetros.

    n_fft      = 4096
    hop_length = 2048

  5
    Testei a compressão logarítmica do Muller. Nenhum resultado. Na verdade, a
    média de precisões cai um pouco. Vou dar uma olhada nos resultados
    individuais, mas, ao que tudo indica, a compressão logarítmica não surte
    efeito positivo.

    Usei o logarítmo natural, pois o livro não especifica nenhuma base (e em
    outros usos de log no livro se especifica explicitamente as bases 10 e 2,
    por isso suponho que a base padrão utilizada seja 'e').


  ÚLTIMOS PASSOS:

    - passar o log no espectrograma As contribuições dos harmonicos superiores
      tem contribuição muito forte em relação aos mais graves
    - escala em milissegundos dos gráficos com suavização temporal no texto


    1) Fazer uma rotina que gera as visualizações de templates de forma mais
       automática.


